{"version":3,"sources":["money.mask.js"],"names":["BaseMask","VanillaMasker","MONEY_MASK_SETTINGS","precision","separator","delimiter","unit","suffixUnit","MoneyMask","getType","getValue","value","settings","mergedSettings","mergeSettings","raw","getRawValueForMask","toMoney","handleBlur","maskedValue","opts","includeSuffix","maskedText","rawText","handleFocus","handleChange","zeroCents","undefined","getRawValue","rawValue","replace","normalizeValue","cleaned","removeNotNumbersForMoney","toString","split","length","lastPart","pop","isLastPartDecimal","join","normalized","Number","validate","_sanitize","toFixed","_insert","text","index","string","substring"],"mappings":"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","sourcesContent":["import BaseMask from './_base.mask';\nimport VanillaMasker from '../internal-dependencies/vanilla-masker';\n\nconst MONEY_MASK_SETTINGS = {\n  precision: 2,\n  separator: ',',\n  delimiter: '.',\n  unit: 'R$',\n  suffixUnit: '',\n};\n\nexport default class MoneyMask extends BaseMask {\n  static getType() {\n    return 'money';\n  }\n\n  getValue(value, settings) {\n    const mergedSettings = super.mergeSettings(MONEY_MASK_SETTINGS, settings);\n\n    const raw = this.getRawValueForMask(value, mergedSettings);\n\n    // empty content should return empty string\n    if (raw === '') {\n      return '';\n    }\n\n    return VanillaMasker.toMoney(raw, mergedSettings);\n  }\n\n  handleBlur(maskedValue, settings) {\n    const opts = super.mergeSettings(MONEY_MASK_SETTINGS, settings);\n    const includeSuffix = opts.suffixUnit ? opts.suffixUnit : '';\n    let { maskedText, rawText } = this.handleFocus(maskedValue, settings);\n    maskedText = this.getValue(maskedText, opts);\n    maskedText = `${maskedText}${includeSuffix}`;\n\n    return { maskedText, rawText };\n  }\n\n  handleChange(value, settings) {\n    const opts = super.mergeSettings(MONEY_MASK_SETTINGS, {\n      ...settings,\n      zeroCents: false,\n    });\n\n    if (value === undefined || value === null) {\n      return { maskedText: '', rawText: this.getRawValue('') };\n    }\n    let maskedText = this.getValue(value, opts);\n    return { maskedText, rawText: this.getRawValue(maskedText) };\n  }\n\n  handleFocus(maskedValue, settings) {\n    if (typeof maskedValue === 'number') {\n      return { maskedText: maskedValue, rawText: maskedValue };\n    }\n    const opts = super.mergeSettings(MONEY_MASK_SETTINGS, {\n      ...settings,\n      zeroCents: false,\n    });\n\n    const rawValue = this.getRawValue(maskedValue, opts);\n    return {\n      maskedText: maskedValue.replace(opts.suffixUnit, ''),\n      rawText: rawValue,\n    };\n  }\n\n  normalizeValue(maskedValue, settings) {\n    if (typeof maskedValue === 'number') {\n      return maskedValue;\n    }\n\n    const mergedSettings = super.mergeSettings(MONEY_MASK_SETTINGS, settings);\n    const cleaned = super\n      .removeNotNumbersForMoney(maskedValue)\n      .toString()\n      .split(mergedSettings.separator);\n\n    // if seperator and delimeter are the same we cannot use the way we did before\n    // this should not happen but if happens for some reason we will try to find decimals\n    if (mergedSettings.separator === mergedSettings.delimiter) {\n      if (cleaned.length === 1) {\n        return cleaned[0];\n      }\n\n      const lastPart = cleaned.pop();\n      const isLastPartDecimal = lastPart.length <= mergedSettings.precision;\n\n      return cleaned.join('') + (isLastPartDecimal ? '.' + lastPart : lastPart);\n    }\n\n    return cleaned.join('').replace(mergedSettings.delimiter, '.');\n  }\n\n  getRawValueForMask(maskedValue, settings) {\n    const normalized = this.normalizeValue(maskedValue, settings);\n\n    if (normalized === '') {\n      return '';\n    }\n\n    return normalized;\n  }\n\n  getRawValue(maskedValue, settings) {\n    const mergedSettings = super.mergeSettings(MONEY_MASK_SETTINGS, settings);\n    const normalized = this.normalizeValue(maskedValue, mergedSettings);\n    return Number(normalized);\n  }\n\n  validate(value, settings) {\n    return true;\n  }\n\n  _sanitize(value, settings) {\n    if (typeof value === 'number') {\n      return value.toFixed(settings.precision);\n    }\n\n    return value;\n  }\n\n  _insert(text, index, string) {\n    if (index > 0) {\n      return (\n        text.substring(0, index) + string + text.substring(index, text.length)\n      );\n    } else {\n      return string + text;\n    }\n  }\n}\n"]}